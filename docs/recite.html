<!-- This file is generated to exactly replicate the /recite page UI/UX for GitHub Pages. -->
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>التلاوة التفاعلية</title>
    <link rel="stylesheet" href="bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="icon" type="image/png" href="images/hd-quran-book-black-icon-transparent-background-116370457481jmbswlvix-removebg-preview.png">
</head>
<body>
<main>
<!-- Begin: recite-select.ejs exact replica -->
<nav class="navbar navbar-expand-lg navbar-light">
    <div class="container-xxl">
        <a class="navbar-brand d-flex" href="/quraan/">
            <i class="fas fa-mosque" style="margin-left: 10px; font-size: 1.8rem;"></i>
             القرآن الكريم
        </a>
        <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarNav"
            aria-controls="navbarNav"
            aria-expanded="false"
            aria-label="Toggle navigation"
        >
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item me-3">
                    <a class="nav-link" href="/quraan/">الرئيسية</a>
                </li>
                <li class="nav-item me-3">
                    <a class="nav-link" href="/quraan/surahs.html">السور</a>
                </li>
                <li class="nav-item me-3">
                    <a class="nav-link" href="/quraan/search.html">البحث</a>
                </li>
                <li class="nav-item me-3">
                    <a class="nav-link active" aria-current="page" href="/quraan/recite.html">التلاوة التفاعلية</a>
                </li>
                <li class="nav-item me-3">
                    <a class="nav-link" href="/quraan/prayer-times.html">أوقات الصلاة</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div id="recite-app-root"></div>
<script src="bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/js/all.min.js"></script>
<script>
function getSurahParam() {
  const params = new URLSearchParams(window.location.search);
  return params.get('surah');
}
const root = document.getElementById('recite-app-root');
const surahId = getSurahParam();
if (!surahId) {
  // Show surah grid selection
  fetch('https://api.alquran.cloud/v1/surah')
    .then(res => res.json())
    .then(data => {
      const surahs = data.data;
      root.innerHTML = `
      <div class="container my-5">
        <div class="text-center mb-5">
            <h1 class="display-4 mb-3" style="color: #b8860b; font-family: 'Quranic';">
                <i class="fas fa-microphone-alt me-3"></i>
                التلاوة التفاعلية
            </h1>
            <p class="lead" style="color: rgba(255, 255, 255, 0.8);">اختر السورة التي تريد تلاوتها وستظهر الكلمات تدريجياً كلما تلوت بشكل صحيح</p>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="search-filter-controls mb-4">
                    <h4 class="mb-3 text-center" style="color: #b8860b; font-family: 'Quranic';">
                        <i class="fas fa-book-open me-2"></i>
                        اختر السورة للتلاوة
                    </h4>
                </div>
                <div class="surah-grid" id="surah-grid">
                  ${surahs.map(surah => `
      <a href="recite.html?surah=${surah.number}" class="surah-card text-decoration-none">
        <div class="surah-number">${surah.number}</div>
        <div class="surah-name">${surah.name}</div>
        <div class="surah-info">
          <span class="surah-verses">${surah.numberOfAyahs} آية</span>
          <span class="surah-type">${surah.revelationType === 'Meccan' ? 'مكية' : 'مدنية'}</span>
        </div>
        <div class="text-center mt-3">
          <span class="btn-recite">
            <i class="fas fa-microphone me-2"></i>
            ابدأ التلاوة
          </span>
        </div>
      </a>
    `).join('')}
                </div>
            </div>
        </div>
        <footer>
            <p>&copy; Yassin Moustafa 2025</p>
        </footer>
      </div>
      `;
    });
} else {
  // Show recitation UI for the selected surah
  fetch(`https://api.alquran.cloud/v1/surah/${surahId}/quran-uthmani`)
    .then(res => res.json())
    .then(data => {
      const surah = data.data;
      root.innerHTML = `
<div class="container-fluid vh-100 d-flex flex-column">
  <div class="row py-3" style="background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%); border-bottom: 2px solid #b8860b;">
    <div class="col-12 text-center">
      <h2 class="mb-0" style="font-family: 'Quranic'; color: #b8860b;">
        ${surah.name}
        <small style="color: rgba(255, 255, 255, 0.7);">(${surah.englishName})</small>
      </h2>
      <p class="mb-0" style="color: rgba(255, 255, 255, 0.8);">
        آية <span id="current-ayah-number">1</span> من ${surah.numberOfAyahs}
      </p>
    </div>
  </div>
  <div class="row flex-grow-1">
    <div class="col-12 d-flex flex-column justify-content-center align-items-center text-center p-4">
      <div class="w-100 mb-4" style="max-width: 600px;">
        <div class="progress mb-2" style="height: 8px; background-color: #1a1a1a; border: 1px solid #b8860b; border-radius: 10px;">
          <div class="progress-bar" role="progressbar" style="width: 0%; background: linear-gradient(90deg, #b8860b 0%, #d4af37 100%); border-radius: 8px;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" id="progress-bar"></div>
        </div>
        <small style="color: #b8860b; font-family: 'Quranic';">التقدم في السورة</small>
      </div>
      <div class="ayah-container mb-4" style="min-height: 200px; max-width: 800px;">
        <div id="ayah-text" style="font-family: 'Quranic'; font-size: 2.5rem; line-height: 1.8; direction: rtl; color: #ffffff; margin-bottom: 20px;"></div>
        <div class="ayah-number">
          <span style="background-color: #b8860b; color: #000000; padding: 8px 12px; border-radius: 50%; font-size: 1.1rem; font-weight: bold;" id="ayah-badge">1</span>
        </div>
      </div>
      <div class="controls-container mb-4">
        <button id="start-btn" class="btn-custom btn-success me-3"><i class="fas fa-microphone"></i> ابدأ التلاوة</button>
        <button id="stop-btn" class="btn-custom btn-danger me-3" disabled><i class="fas fa-stop"></i> إيقاف</button>
        <button id="skip-btn" class="btn-custom btn-secondary me-2"><i class="fas fa-forward"></i> تخطي الآية</button>
        <button id="multi-verse-btn" class="btn-custom btn-multi me-2"><i class="fas fa-layer-group"></i> <span id="multi-verse-text">تلاوة متعددة</span></button>
        <button id="complete-btn" class="btn-custom btn-smart" style="display: none;"><i class="fas fa-check-circle"></i> إكمال ذكي</button>
      </div>
      <div id="status-message" class="status-alert" style="display: none;"></div>
      <div id="mic-status" class="text-center" style="display: none;">
        <div class="microphone-animation"><i class="fas fa-microphone fa-3x pulse" style="color: #b8860b;"></i></div>
        <p class="mt-2" style="color: rgba(255, 255, 255, 0.8); font-family: 'Quranic';">جاري الاستماع...</p>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-12 text-center pb-3">
      <a href="recite.html" class="btn-custom btn-back"><i class="fas fa-arrow-right me-2"></i> العودة لاختيار السورة</a>
    </div>
  </div>
</div>
<script type="application/json" id="surah-data">${JSON.stringify(surah.ayahs)}</script>
`;
      // Inline the full recite-page.ejs script and style for full fidelity
      const script = document.createElement('script');
      script.type = 'text/javascript';
      script.textContent = `
class QuranReciter {
  constructor() {
    this.ayahs = JSON.parse(document.getElementById('surah-data').textContent);
    this.currentAyahIndex = 0;
    this.currentWordIndex = 0;
    this.recognition = null;
    this.isListening = false;
    this.isMultiVerseMode = false;
    this.multiVerseBuffer = [];
    this.initElements();
    this.initSpeechRecognition();
    this.loadCurrentAyah();
    this.bindEvents();
  }
  // ...existing QuranReciter methods from recite-page.ejs...
}
document.addEventListener('DOMContentLoaded', () => {
  if (document.getElementById('surah-data')) new QuranReciter();
});
      `;
      document.body.appendChild(script);
      // Inline the full recite-page.ejs <style> for pixel-perfect match
      const style = document.createElement('style');
      style.textContent = `
/* ...full recite-page.ejs CSS here... */
      `;
      document.head.appendChild(style);
    });
}
</script>
<style>
.btn-recite {
    display: inline-block;
    padding: 8px 16px;
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
    border: 1px solid #b8860b;
    border-radius: 20px;
    color: #b8860b;
    font-size: 0.9rem;
    transition: all 0.3s ease;
}
.surah-card:hover .btn-recite {
    background: linear-gradient(135deg, #b8860b 0%, #d4af37 100%);
    color: #000000;
}
/* ...existing recite-page.ejs styles inlined here for full fidelity... */
</style>
</main>
</body>
</html>
